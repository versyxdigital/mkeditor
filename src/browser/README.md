# MKEditor Web App

This folder contains the source for the browser-based web app (not the Electron main process). Desktop-only wiring is enabled via the execution bridge. The entry point for the web app is `index.ts`.

## Structure Overview


- `index.ts`: Bootstraps the UI and editor, detects runtime, registers providers, and initializes UI helpers
- `icons.ts`: Registers FontAwesome icons and starts DOM watching so icon placeholders render
- `version.ts`: App version constant used by the UI, generated by NPM commands
- `config.ts`: Default `EditorSettings` and `ExportSettings`
- `dom.ts`: Centralized DOM handles and UI utilities (splash fade, Bootstrap tooltips etc.)
- `util.ts`: General utilities (debounce, OS detection, bridge detection etc)
- `views/index.html`: Base HTML template for the web renderer
- `assets/`: Static assets and styles
- `core/`: Editor and runtime orchestration
  - `EditorManager.ts`: Creates Monaco instance, renders markdown, wires events and providers
  - `BridgeManager.ts`: Desktop-only orchestrator for IPC via the execution bridge
  - `BridgeListeners.ts`: Helper for bridge events and synchronization
  - `FileManager.ts`, `FileTreeManager.ts`: Tabbed file handling and explorer tree
  - `HTMLExporter.ts`, `Markdown.ts`: Export/rendering helpers
  - `ToolbarListeners.ts`: Helper for registering and managing toolbar event listeners
  - `mappings/`: Command and context‑menu mappings for providers and the explorer
  - `completion/`: Data and logic (e.g. fenced blocks, list markers) for the completion provider
- `events/`: Custom editor event/dispatcher system, lighter than IPC, restrained to renderer context
- `interfaces/`: Interfaces for providers, editor settings, bridge API, and dispatcher events
- `extensions/`: Editor and markdown renderer extensions

## How `index.ts` Wires It Together

1. Imports `icons.ts` so icons are registered immediately and UI can render them
2. Detects the execution mode using `getExecutionBridge()` from `util.ts`:
   - Web mode: returns `'web'` and hides the file‑tree sidebar
   - Desktop mode: returns a bridge object exposed by the Electron preload script
3. Creates an `EditorDispatcher` and an `EditorManager` (initializes Monaco, preview, and listeners)
4. Registers providers on the `EditorManager`:
   - `CommandProvider` for toolbar, keyboard shortcuts, and command dropdowns
   - `SettingsProvider` and `ExportSettingsProvider` for settings persistence
   - `CompletionProvider` for suggestions and list continuation
5. **Desktop only**: constructs a `BridgeManager`, attaches the providers, enables `mked://` link handling and starts content change tracking across the bridge.
6. Initializes UI helpers from `dom.ts`: tooltips, draggable editor/preview split (plus reset), sidebar toggle, and a short splash screen fade.

`index.ts` is the **composition root**: it decides web vs desktop mode, creates the editor, registers capabilities via providers, and then activates the UI utilities so the app is interactive in the browser.

